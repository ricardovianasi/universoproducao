!function(a,b){var c=function(a,c){this.element=a,this.$element=b(a),this.options=c};c.prototype={defaults:{addEventSelector:".nestable-serialize-add",removeEventSelector:".nestable-serialize-remove",fieldSelector:".nestable-serialize-input",serializeFieldSelector:".nestable-serialize-serialized",formSelector:".nestable-serialize-form",serializeEventSelector:".nestable-serialize-submit"},init:function(){this.config=b.extend({},this.defaults,this.options,this.$element.data());var a=this;b(a.config.addEventSelector,a.$element).on("click",function(c){c.preventDefault();var d=b(a.config.fieldSelector,a.$element);if(d){var e="",f="";d.is("select")&&(e=d.children("option:selected").val(),f=d.children("option:selected").text()),e&&(a.addNode(e,f),d.val(""))}}),b(document).on("click",a.config.removeEventSelector,function(a){a.preventDefault();var c=b(this).closest(".dd-item");c.children(".dd-handle").first().css({"border-color":"red",background:"#FFB5B5"}),c.slideUp(function(){c.remove()})}),b(a.config.serializeEventSelector).on("click",function(c){c.preventDefault(),console.log("save");var d=b(".dd").nestable("serialize");form=b(a.config.formSelector),inputSerialize=b(a.config.serializeFieldSelector),console.log(form),inputSerialize&&inputSerialize.val(JSON.stringify(d))})},addNode:function(a,c){var d=this,e=b('<li class="dd-item" data-id="'+a+'">').append('<div class="item-controls"><a class="'+d.config.removeEventSelector.replace(".","")+'" role="button">excluir</a></div>').append('<div class="dd-handle"><span class="item-title">'+c+"</span></div>");b(".dd-list",d.$element).append(e)}},c.defaults=c.prototype.defaults,b.fn.nestableSerialize=function(a){return this.each(function(){new c(this,a).init()})},a.NestableSerialize=Plugin}(window,jQuery);